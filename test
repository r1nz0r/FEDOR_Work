Последняя правка которую нужно делать - создавай две базы в Enveloper. Одна - как есть сейчас, ничего не меняется. Вторая будет с изменением.
Смотри. Сейчас у нас в табилце есть 2 поперечки - Asw1 и Asw2 (i, j узлы еще). Мы огибаем их отдельно друг от друга. Получается что Asw1 может быть от отличной комбинации максимум чем в Asw2.
Получается завышенное значение поперечки, так как результат мы выводим равным Asw1 + Asw2 в программе нашей.
Твоя задача - если тип элемента (elemType) равен 2, то огибать внутри себя виртуально не отдельно Asw1 и Asw2, а их сумму.
Создай для себя отдельный столбец, куда будешь записывать сумму, и огибай по этой сумме (Asw1i + Asw2i, Asw1j + Asw2j).
Далее в итоговй таблице ты не добавляешь её, а делаешь следующее - в Asw1 записываешь результат суммы, а в Asw2 просто ставишь ноль.
Понятно объяснил?
